# 機率推論 (Probability & Inference)

## Naive Bayes Algorithm

P(x)=0.5
P(y)=0.2
P(z)=0.3

P(x,y,z) = P(x) * P(y) * P(z) = 0.03


執行：

```
$ node naiveBayes
P(x,y,z) =  0.03
```

## Gibbs Sampling Algorithm

* https://mdbookspace.com/view/ai/gibbs.md

```
$ node gibbs
P = [0.5,0.5]
P = [0.6,0.4]
P = [0.62,0.38]
P = [0.624,0.376]
P = [0.6248,0.3752]
5/8=0.625 3/8=0.375
```

## Metropolis-Hasting Algorithm

* https://mdbookspace.com/view/ai/metropolis.md

```
$ node .\metropolis.js
Q = [[0.5,0.5],[0.5,0.5]]
A = [[1,0.6],[1.6666666666666667,1]]
diff = 0.2
Q = [[0.7,0.3],[0.5,0.5]]
A = [[1,1],[1,1]]
diff = 0
```

## EM Algorithm

```
$ npm i j6

$ node em
pA=0.6,0.4 pB=0.5,0.5 delta=9.9999
pA=0.7130122354005162,0.28698776459948394 pB=0.5813393083136625,0.41866069168633735 delta=0.113
pA=0.7452920360819945,0.25470796391800554 pB=0.5692557501718727,0.4307442498281272 delta=0.0323
pA=0.768098834367321,0.23190116563267898 pB=0.5495359141383478,0.45046408586165226 delta=0.0228
pA=0.7831645842999736,0.2168354157000264 pB=0.5346174541475204,0.4653825458524797 delta=0.0151
pA=0.7910552458637528,0.2089447541362473 pB=0.526281167029932,0.4737188329700681 delta=0.0083
pA=0.7945325379936994,0.2054674620063006 pB=0.5223904375178748,0.47760956248212527 delta=0.0039
pA=0.7959286672497986,0.20407133275020142 pB=0.5207298780860259,0.4792701219139741 delta=0.0017
```

## Markov Model

* 參考： 自然語言處理 -- Hidden Markov Model 
  * http://cpmarkchang.logdown.com/posts/192352

```
// 狀態機率： P(0) = 0.2, P(1) = 0.8
// 轉移機率： P(x => y)
//    0   1
// 0  0.3 0.7
// 1  0.6 0.4
```

執行結果：

```
$ node markov
P([1,0,1,1])=0.1344  // = 0.8*0.6*0.7*0.4
```

## Viterbi Algorithm

* 參考： https://zh.wikipedia.org/wiki/%E7%BB%B4%E7%89%B9%E6%AF%94%E7%AE%97%E6%B3%95

機率表格：

```
// N 0.6 => 喵 0.4 | 汪 0.6
// V 0.4 => 喵 0.5 | 汪 0.5
//    N   V
// N  0.3 0.7
// V  0.8 0.2
```

執行結果：

```
$ node viterbi
t=1 path={"N":["V","N"],"V":["N","V"]}
t=2 path={"N":["N","V","N"],"V":["V","N","V"]}
T=[{"N":0.24,"V":0.2},{"N":0.06400000000000002,"V":0.08399999999999999},{"N":0.040319999999999995,"V":0.022400000000000003}]
prob=0.040319999999999995 path=["N","V","N"]
```


